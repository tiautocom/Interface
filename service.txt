ADD TABELA NUM_CAIXA
BANDEIRA BIT,
PRECO_TOTA NCHAR(20),
CUPOM BIT

ADD TABELA USUARIO
LOGADO BIT,
PERMISSAO BIT

ADD PARAMETRO
AGRUPAR BIT
PAGTO_VENDA_XML BIT
TIME_TELA_DESC INT,
HOMOLOGACAO_TESTE BIT,
VENDA_XML BIT

ADD TABELA DEPARTAMENTO
AVISO BIT

ADD TABELA VENDA TAG
TAG BIT,
ANP NCHAR(10)

ADD TABELA PAGAMENTO_VENDA
TAG BIT

CREATE PROCEDURE [dbo].[uspDepartamentoPesquisarAviso]
	@NUM_DEPAR INT
AS 
BEGIN 
	SELECT ID, AVISO FROM DEPARTAMENTO WHERE DEPARTAMENTO.ID=@NUM_DEPAR
END
GO

CREATE PROCEDURE [dbo].[uspNumVendaPesquisarCaixa]
	@NUM_CAIXA INT
AS 
BEGIN 
	SELECT NUM_VENDA, BANDEIRA, PRECO_TOTAL, CUPOM FROM NUM_CAIXA WHERE NUM_CAIXA=@NUM_CAIXA 

		DELETE FROM VENDA_TEMP
END;


CREATE PROCEDURE [dbo].[uspUsuarioFecharLogin]
	@LOGADO BIT,
	@NUM_CAIXA INT
AS 
BEGIN 

	UPDATE USUARIO SET LOGADO=@LOGADO WHERE NUM_CAIXA=@NUM_CAIXA

	SELECT @NUM_CAIXA AS RETORNO;
END;


CREATE PROCEDURE [dbo].[uspUsuarioAbrirLogin]
	@ID_USUARIO INT,
	@STATUS BIT
AS 
BEGIN 
	UPDATE USUARIO SET LOGADO=@STATUS WHERE ID_USUARIO=@ID_USUARIO;

	SELECT @ID_USUARIO AS RETORNO;
END
GO

CREATE PROCEDURE [dbo].[uspDepartamentoPesquisarAviso]
	@NUM_DEPAR INT
AS 
BEGIN 
	SELECT ID, AVISO FROM DEPARTAMENTO WHERE DEPARTAMENTO.ID=@NUM_DEPAR
END
GO

CREATE TABLE [dbo].[TIPO_USUARIO](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[TIPO_USUARIO] [int] NULL,
	[PERMISSAO] [bit] NULL,
 CONSTRAINT [PK_TIPO_USUARIO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

CREATE PROCEDURE [dbo].[uspPagamentoVendaCadastrar]
	@ID_CLIENTE INT,
	@ID_USUARIO INT,
	@TIPO_PAGAMENTO INT,
	@VALOR DECIMAL(18,2),
	@CNPJ NCHAR(30),
	@NUM_CUPOM INT,
	@BAIXADO BIT,
	@DT DATE,
	@TROCO DECIMAL(18,2),
	@NUM_CAIXA INT,
	@FECHADO BIT,
	@TAG BIT
AS 
BEGIN 
	INSERT INTO PAGAMENTO_VENDA(ID_CLIENTE, ID_USUARIO, TIPO_PAGAMENTO, VALOR, CNPJ, NUM_CUPOM, BAIXADO, DT, TROCO, NUM_CAIXA, FECHADO, TAG)
	VALUES(@ID_CLIENTE, @ID_USUARIO, @TIPO_PAGAMENTO, @VALOR, @CNPJ, @NUM_CUPOM, @BAIXADO, @DT, @TROCO, @NUM_CAIXA, @FECHADO, @TAG)
	SELECT @@IDENTITY AS RETORNO
END

CREATE PROCEDURE [dbo].[uspParametroAlterarCupom]
	@BANDEIRA BIT,
	@NUM_CAIXA INT
AS 
BEGIN 
	UPDATE NUM_CAIXA SET BANDEIRA=@BANDEIRA WHERE NUM_CAIXA=@NUM_CAIXA;

	SELECT @NUM_CAIXA AS RETORNO;
END
